<ion-menu contentId="main-content">
  <ion-header>
    <ion-toolbar>
      <ion-icon
        [name]="sideNavObject.icon"
        slot="start"
        size="large"
        class="ion-margin-start"
        color="primary"
      ></ion-icon>
      <ion-label style="flex: 1; text-align: left" class="ion-padding-start">
        <h2>{{ sideNavObject.title }}</h2>
        <p>
          <ion-note color="medium">{{ sideNavObject.subTitle }}</ion-note>
        </p>
      </ion-label>
    </ion-toolbar>
  </ion-header>

  <ion-content class="ion-padding">
    @for (section of sideNavObject.sections; track section.title) {
      @if (section.title) {
        <span class="section-title">{{ section.title }}</span>
      }

      @for (opt of section.sideNavOptions; track opt.title) {
        @if (opt.permission) {
          <ng-container *appHasPermission="opt.permission">
            <ng-container
              *ngTemplateOutlet="botaoMenu; context: { $implicit: opt }"
            ></ng-container>
          </ng-container>
        } @else {
          <ng-container
            *ngTemplateOutlet="botaoMenu; context: { $implicit: opt }"
          ></ng-container>
        }
      }
    }

    @if (itemsPendentes.length > 0) {
      <ion-card color="warning" class="ion-margin-bottom">
        <ion-card-content>
          <p>
            <strong>{{ itemsPendentes.length }}</strong> ocorrÃªncias salvas
            offline.
          </p>
          <ion-button
            expand="block"
            color="dark"
            size="small"
            class="ion-margin-top"
            (click)="iniciarSincronizacao()"
          >
            <ion-icon name="cloud-upload" slot="start"></ion-icon>
            Sincronizar Agora
          </ion-button>
        </ion-card-content>
      </ion-card>
    }
  </ion-content>

  <ion-footer class="ion-no-border ion-padding">
    <ion-button expand="block" color="danger" fill="outline" (click)="logOut()">
      <ion-icon name="log-out-outline" slot="start"></ion-icon>
      Sair
    </ion-button>
  </ion-footer>
</ion-menu>

<ng-template #botaoMenu let-opt>
  <ion-button
    expand="block"
    fill="clear"
    class="ion-text-capitalize"
    [routerLink]="[opt.path]"
    routerLinkActive="active-route"
    [routerLinkActiveOptions]="{ exact: false }"
  >
    <ion-icon [name]="opt.icon" slot="start"></ion-icon>
    {{ opt.title }}
  </ion-button>
</ng-template>

<div class="ion-page" id="main-content">
  <ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-menu-button></ion-menu-button>
      </ion-buttons>
      <ion-title>{{ sideNavObject.title }}</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-content class="ion-padding">
    <ion-router-outlet></ion-router-outlet>
  </ion-content>
</div>
